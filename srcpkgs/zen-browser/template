pkgname=zen-browser
version=1.14.9b
revision=1
archs="x86_64"
hostmakedepends="tar xz"
short_desc="Performance oriented Firefox-based web browser"
maintainer="kevin <kevin@disroot.org>"
license="MPL-2.0"
homepage="https://github.com/zen-browser/desktop"
distfiles="https://github.com/zen-browser/desktop/releases/download/${version}/zen.linux-x86_64.tar.xz"
checksum=3d5264cd45d41c074eb7c929fbc2a8eeae4f3beeef765ae8b3628c7a2b4423a1

do_install() {
    # directories
    install -dm755 "${DESTDIR}/opt/zen-browser" "${DESTDIR}/opt/zen-browser/distribution" "${DESTDIR}/usr/bin" "${DESTDIR}/usr/share/applications" "${DESTDIR}/usr/share/pixmaps"

    # extracting binary package
    tar -xvf ${XBPS_SRCDISTDIR}/${pkgname}-${version}/zen.linux-x86_64.tar.xz -C ${DESTDIR}/opt/$pkgname --strip-components=1

    # symbolic link
    ln -sf /opt/zen-browser/zen ${DESTDIR}/usr/bin/zen

    # icons
    for size in 16 32 48 64 128; do
        vinstall "${DESTDIR}/opt/zen-browser/browser/chrome/icons/default/default${size}.png" 644 "usr/share/pixmaps/zen_${size}.png"
    done

    # install .desktop file
    vinstall "${FILESDIR}/zen.desktop" 644 usr/share/applications

    # using system dictionary
    ln -Ts /usr/share/hunspell ${DESTDIR}/opt/$pkgname/dictionaries
    ln -Ts /usr/share/hyphen ${DESTDIR}/opt/$pkgname/hyphenation
    ln -sf /usr/lib/libnssckbi.so ${DESTDIR}/opt/$pkgname/libnssckbi.so

    # install policies files
    vinstall ${FILESDIR}/policies.json 644 opt/$pkgname/distribution/
}
